"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[181],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(n),m=i,v=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return n?a.createElement(v,l(l({ref:t},c),{},{components:n})):a.createElement(v,l({ref:t},c))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8042:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:4},l="Variables",o={unversionedId:"concepts/env_vars",id:"concepts/env_vars",title:"Variables",description:"Environment variables are key-value pairs defined to match a specific application environment (local, dev, prod, etc.). Often they contain",source:"@site/docs/concepts/env_vars.md",sourceDirName:"concepts",slug:"/concepts/env_vars",permalink:"/concepts/env_vars",draft:!1,editUrl:"https://github.com/cyclic-software/docs/blob/main/docs/concepts/env_vars.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Databases",permalink:"/concepts/database"},next:{title:"File System",permalink:"/concepts/file_system"}},s={},p=[{value:"Setting Variables",id:"setting-variables",level:2},{value:"Local",id:"local",level:3},{value:"Cyclic",id:"cyclic",level:3},{value:"Key-Value Editor:",id:"key-value-editor",level:4},{value:"Bulk Editor:",id:"bulk-editor",level:4},{value:"Accessing Variables",id:"accessing-variables",level:2},{value:"Frontend",id:"frontend",level:3},{value:"Backend",id:"backend",level:3},{value:"Build",id:"build",level:3},{value:"Reserved Environment Variables",id:"reserved-environment-variables",level:2},{value:"Watch an overview here:",id:"watch-an-overview-here",level:2}],c={toc:p};function d(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"variables"},"Variables"),(0,i.kt)("p",null,"Environment variables are key-value pairs defined to match a specific application environment (local, dev, prod, etc.). Often they contain "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Flags that control the application behavior"),(0,i.kt)("li",{parentName:"ul"},"Secrets and api keys that can differ by environment")),(0,i.kt)("h2",{id:"setting-variables"},"Setting Variables"),(0,i.kt)("h3",{id:"local"},"Local"),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"Do not put your ",(0,i.kt)("inlineCode",{parentName:"mdxAdmonitionTitle"},".env")," file in GitHub"),(0,i.kt)("p",{parentName:"admonition"},"Especially if your repo is public. Make sure to add ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file to your ",(0,i.kt)("inlineCode",{parentName:"p"},".gitignore"),". If you accidentally push your ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file to GitHub, its contents will be permanently in the repository's history - ",(0,i.kt)("strong",{parentName:"p"},"even if you delete it afterwards"))),(0,i.kt)("p",null,"On local, there are many ways to get environment variables into your application. Refer to these popular packages for more info:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"env-cmd - ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/env-cmd",target:"_blank"},(0,i.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/env-cmd"},"https://www.npmjs.com/package/env-cmd"))," (recommended)",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"can be used in package.json scripts to injects variables from ",(0,i.kt)("inlineCode",{parentName:"li"},".env")," without changes to application code. For example: ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"in ",(0,i.kt)("inlineCode",{parentName:"li"},"dev")," - load local env vars from ",(0,i.kt)("inlineCode",{parentName:"li"},".env")," and watch for file changes"),(0,i.kt)("li",{parentName:"ul"},"when deployed, Cyclic runs ",(0,i.kt)("inlineCode",{parentName:"li"},"start"),". env-cmd is not needed since variables are available automatically. This way ",(0,i.kt)("inlineCode",{parentName:"li"},"env-cmd")," only has to be a ",(0,i.kt)("inlineCode",{parentName:"li"},"devDependency")," ")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'...\n "scripts": {\n        "start": "node index.js",\n        "dev": "env-cmd node --watch index.js"\n   }\n...\n')),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"tip: as of node 18, ",(0,i.kt)("inlineCode",{parentName:"li"},"node --watch")," can be used to watch for file changes in place of ",(0,i.kt)("inlineCode",{parentName:"li"},"nodemon")))))),(0,i.kt)("li",{parentName:"ul"},"dotenv - ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/dotenv",target:"_blank"},(0,i.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/dotenv"},"https://www.npmjs.com/package/dotenv")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"sets variables from a ",(0,i.kt)("inlineCode",{parentName:"li"},".env")," file with:",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"require('dotenv').config()\n")))))),(0,i.kt)("h3",{id:"cyclic"},"Cyclic"),(0,i.kt)("p",null,"Environment variables can be set after a first deployment in an app's dashboard via the ",(0,i.kt)("strong",{parentName:"p"},"Variables")," tab."),(0,i.kt)("p",null,"Cyclic stores environment variables securely by encrypting them at rest, they are visible only to users that have permissions to the app environment. "),(0,i.kt)("admonition",{title:"Changes are applied immediately",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Changes to environment variables are applied immediately to running apps ",(0,i.kt)("strong",{parentName:"p"},"without a re-deployment"),".")),(0,i.kt)("p",null,"All apps are preset with the following variables:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYCLIC_URL")," - the default url of the app"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYCLIC_DB")," - the name of the AWS DynamoDB table available to the app"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYCLIC_BUCKET_NAME")," - the name of the AWS S3 Bucket available to the app"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CYCLIC_APP_ID")," - the app environments unique id ")),(0,i.kt)("p",null,"There are two ways to set up variables:"),(0,i.kt)("h4",{id:"key-value-editor"},"Key-Value Editor:"),(0,i.kt)("img",{src:"/img/vars/kv_editor.png",width:"650px"}),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Add the variable name and value with ",(0,i.kt)("em",{parentName:"p"},"+ Add Variable"),", then ",(0,i.kt)("em",{parentName:"p"},"Save"))),(0,i.kt)("h4",{id:"bulk-editor"},"Bulk Editor:"),(0,i.kt)("img",{src:"/img/vars/bulk_editor.png",width:"650px"}),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"A text editor that allows you to work on multiple variables at once in a similar syntax to ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," files with the exceptions:"),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},"Comments are not supported"),(0,i.kt)("li",{parentName:"ul"},"Quotes not required and are passed as part of the value ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'VAR="MY VALUE"')," will result in your code seeing ",(0,i.kt)("inlineCode",{parentName:"li"},'"MY VALUE"')," rather than ",(0,i.kt)("inlineCode",{parentName:"li"},"MY VALUE")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"VAR")," instead should be set as ",(0,i.kt)("inlineCode",{parentName:"li"},"VAR=MY VALUE")))))),(0,i.kt)("h2",{id:"accessing-variables"},"Accessing Variables"),(0,i.kt)("h3",{id:"frontend"},"Frontend"),(0,i.kt)("admonition",{title:"The frontend does not have access to environment variables",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Variable values often include database secrets and API keys - they should never be exposed to the frontend.")),(0,i.kt)("h3",{id:"backend"},"Backend"),(0,i.kt)("p",null,"Application code on the ",(0,i.kt)("strong",{parentName:"p"},"backend")," has access to variables via ",(0,i.kt)("inlineCode",{parentName:"p"},"process.env")," during runtime. "),(0,i.kt)("h3",{id:"build"},"Build"),(0,i.kt)("p",null,"Environment variables that are set for the runtime are also accessible to the scripts defined in ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")),(0,i.kt)("admonition",{title:"Support for variables in first deployment",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Support for setting environment variables before a first deployment is coming soon."),(0,i.kt)("p",{parentName:"admonition"},"Currently, as a workaround - consider modifying your build step to pass. This will allow you to use the app dashboard to add variables. Once added, revert your build scripts to their original state. Variables will be available for all subsequent builds.")),(0,i.kt)("h2",{id:"reserved-environment-variables"},"Reserved Environment Variables"),(0,i.kt)("p",null,"Cyclic apps run on AWS and have pre-configured AWS credentials for access to the built-in S3 storage and DynamoDB database. "),(0,i.kt)("p",null,"For this, Cyclic reserves the following environment variables:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"AWS_REGION\nAWS_ACCESS_KEY_ID\nAWS_SECRET_KEY\nAWS_SECRET_ACCESS_KEY\n")),(0,i.kt)("p",null,"If you are using resources in your own AWS account and would like you add your own credentials.\nConsider using alternative environment variables and setting the credentials on the SDK clients directly:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'    const { S3Client } = require("@aws-sdk/client-s3");\n    let client = new S3Client({\n        region: process.env.MY_REGION,\n        credentials:{\n            accessKeyId: process.env.MY_AWS_ACCESS_KEY_ID,\n            secretAccessKey: process.env.MY_AWS_SECRET_ACCESS_KEY\n        }\n    });\n')),(0,i.kt)("h2",{id:"watch-an-overview-here"},"Watch an overview here:"),(0,i.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/qGtEPIbB-7k",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}))}d.isMDXComponent=!0}}]);